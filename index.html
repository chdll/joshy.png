<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello World!</title>

  </head>
  <body>
    <h1>ðŸ’– Hello World!</h1>
    <p>Welcome to your Electron application.</p>
    <p id="timeDisplay">Last Mouse Move Time: <span id="timeValue"></span></p>
    <video src="https://cdn.zilpe.co.uk/plssub.mp4" autoplay loop muted></video>
    <button type = "button" id = "fadeout">fade out</button>

    <script type="module" src="/src/renderer.js"></script>
    <script scr="https://docs.opencv.org/4.10.0/opencv.js"></script>
    <script>
    
    let distracted = false;
      // Updates lastMouseMoveTime when the mouse is moved
    var lastInputTime = Date();
    var keyboardMouseInput = function () {
      lastInputTime = new Date();
    }
    document.addEventListener('mousemove', keyboardMouseInput, false);
    document.addEventListener('keydown', keyboardMouseInput, false);
    document.addEventListener('keyup', keyboardMouseInput, false);

    // Check time difference every second
    setInterval(() => {
      const currentTime = new Date();
      const timeDifference = (currentTime - lastInputTime) / 1000; // Convert to seconds

      if(typeof timeDifference === NaN){
        timeDifference = 0
      };

      if(timeDifference > 20 && distracted == false) {
        distractedUser(); // Call the function if more than 20 seconds elapse between inputs
        distracted = true;
      }
      else{
        document.getElementById('timeValue').textContent = timeDifference.toString();
      };
    }, 1000);

    //placeholder for function when they are distracted
    function distractedUser(){
      distracted = false
      console.log("User is distracted")
    }

    // Time at start of program
    // probably change to be initialised when user presses start
    const startTime = new Date();

    function startPomodoroTimer() {
      console.log("25 Minute Timer Started at: " + (new Date()).toDateString());
    };
    function startBreakTimer() {
      console.log("5 Minute Break Timer Started at: " + (new Date()).toDateString());
    };
    function scheduleTimers() {
      startPomodoroTimer(); // Start the Pomodoro timer immediately

      setInterval(() => {
        const elapsedTime = Date.now() - startTime; // Calculate elapsed time in milliseconds

        // Trigger startPomodoroTimer every 30 seconds
        if (elapsedTime % 30000 < 1000 && elapsedTime > 0) {
          startPomodoroTimer();
        }
        // Trigger startBreakTimer 25 seconds into each 30-second cycle
        else if (elapsedTime % 30000 >= 25000 && elapsedTime % 30000 < 26000) {
          startBreakTimer();
        }

        console.log("Elapsed time: " + elapsedTime + " ms");
    }, 1000); // Check every second
}
    scheduleTimers()
    </script>
  </body>
</html>